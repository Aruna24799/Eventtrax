<!DOCTYPE html>
<html>
<head>
<title>EventTrax</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
background:#020617;
color:white;
font-family:sans-serif;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
margin:0;
}

.box{
border:2px solid #0ea5e9;
padding:30px;
border-radius:15px;
width:350px;
text-align:center;
box-shadow:0 0 25px #0ea5e9;
}

input,select,button{
width:100%;
padding:10px;
margin:8px 0;
border-radius:6px;
border:none;
}

button{
background:#0ea5e9;
color:white;
cursor:pointer;
}

.hidden{display:none}
</style>
</head>

<body>

<div class="box">

<h2>EventTrax</h2>

<div id="auth">
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button id="loginBtn">Login</button>
<button id="signupBtn">Signup</button>
</div>

<div id="app" class="hidden">

<input id="eventName" placeholder="Event name">
<button id="createBtn">Create Event</button>

<select id="events"></select>

<input id="username" placeholder="Your name">
<button id="joinBtn">Join</button>

<input id="rating" placeholder="Rating 1-5">
<input id="message" placeholder="Feedback">
<button id="feedbackBtn">Submit Feedback</button>

<button id="certBtn">Download Certificate</button>
<button id="logoutBtn">Logout</button>

</div>

</div>

<script>
alert("JS loaded");
const supabase = window.supabase.createClient(
"https://pxtpsugbuunjzurdvzkc.supabase.co",
"YOUR_ANON_KEY"
);

const authBox = document.getElementById("auth");
const appBox = document.getElementById("app");

document.getElementById("signupBtn").addEventListener("click", async () => {

const email=document.getElementById("email").value;
const password=document.getElementById("password").value;

const {error}=await supabase.auth.signUp({email,password});

if(error){ alert(error.message); return; }

alert("Signup success");
});

document.getElementById("loginBtn").addEventListener("click", async () => {

const email=document.getElementById("email").value;
const password=document.getElementById("password").value;

const {error}=await supabase.auth.signInWithPassword({email,password});

if(error){ alert(error.message); return; }

authBox.classList.add("hidden");
appBox.classList.remove("hidden");

loadEvents();
});

document.getElementById("logoutBtn").addEventListener("click", async () => {
await supabase.auth.signOut();
location.reload();
});

document.getElementById("createBtn").addEventListener("click", async () => {

const name=document.getElementById("eventName").value;

await supabase.from("events").insert({name});
document.getElementById("eventName").value="";
loadEvents();
});

document.getElementById("joinBtn").addEventListener("click", async () => {

await supabase.from("participants").insert({
name:document.getElementById("username").value,
event_id:document.getElementById("events").value
});

alert("Joined");
});

document.getElementById("feedbackBtn").addEventListener("click", async () => {

await supabase.from("feedback").insert({
event_id:document.getElementById("events").value,
rating:document.getElementById("rating").value,
message:document.getElementById("message").value
});

alert("Feedback saved");
});

document.getElementById("certBtn").addEventListener("click", ()=>{
alert("Certificate demo");
});

async function loadEvents(){
const {data}=await supabase.from("events").select("*");
const select=document.getElementById("events");
select.innerHTML="";
data.forEach(e=>{
select.innerHTML+=`<option value="${e.id}">${e.name}</option>`;
});
}

</script>

</body>
</html>

